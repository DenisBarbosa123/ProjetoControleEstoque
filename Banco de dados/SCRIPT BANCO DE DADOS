-- CREATE TABLES

CREATE TABLE USUARIO(
    CPF VARCHAR(12) NOT NULL,
    NOME VARCHAR(40) NOT NULL,
    TELEFONE VARCHAR ,
    EMAIL VARCHAR(40) NOT NULL,
    LOGIN VARCHAR(40) NOT NULL,
    SENHA VARCHAR(30) NOT NULL,
    FK_NOME_CARGO VARCHAR NOT NULL,
    PRIMARY KEY (CPF)
);

CREATE TABLE PRODUTO(
    CODIGO_PRODUTO SERIAL NOT NULL,
    NOME VARCHAR(40) NOT NULL,
    VALOR FLOAT NOT NULL,
    ESTOQUE_MINIMO INTEGER NOT NULL,
    QUANTIDADE INTEGER NOT NULL,
    PRIMARY KEY (CODIGO_PRODUTO)
);

CREATE TABLE NOTAFISCAL(
    FK_PRODUTO INT NOT NULL,
    CAMINHO_NF VAR(50) NOT NULL
)

CREATE TABLE CARGO(
    NOME VARCHAR(40) NOT NULL,
    PRIMARY KEY(NOME)
);

CREATE TABLE SAIDA(
    CODIGO_SAIDA SERIAL NOT NULL,
    DATA TIMESTAMP NOT NULL,
    DESTINO VARCHAR(50) NOT NULL,
    PRIMARY KEY(CODIGO_SAIDA)
);

CREATE TABLE ENTRADA(
    CODIGO_ENTRADA SERIAL NOT NULL,
    DATA TIMESTAMP NOT NULL,
    ORIGEM VARCHAR(50) NOT NULL,
    PRIMARY KEY (CODIGO_ENTRADA)
);

CREATE TABLE EXECUTA_ENTRADA(
    FK_USUARIO VARCHAR NOT NULL, 
    FK_PRODUTO INTEGER NOT NULL,
    FK_ENTRADA INTEGER NOT NULL
);

CREATE TABLE REALIZA_SAIDA(
    FK_USUARIO VARCHAR NOT NULL, 
    FK_PRODUTO INTEGER NOT NULL,
    FK_SAIDA INTEGER NOT NULL
);

CREATE TABLE ENDERECO(
    FK_USUARIO VARCHAR NOT NULL,
    RUA VARCHAR(50) NOT NULL,
    NUMERO INTEGER NOT NULL,
    BAIRRO VARCHAR(50) NOT NULL,
    CEP VARCHAR NOT NULL
);

-- CREATE FOREIGN KEY

ALTER TABLE EXECUTA_ENTRADA
ADD CONSTRAINT FK_USUARIO_ENTRADA 
FOREIGN KEY (FK_USUARIO) 
REFERENCES USUARIO(CPF);

ALTER TABLE EXECUTA_ENTRADA
ADD CONSTRAINT FK_PRODUTO_ENTRADA 
FOREIGN KEY (FK_PRODUTO) 
REFERENCES PRODUTO(CODIGO_PRODUTO);

ALTER TABLE EXECUTA_ENTRADA
ADD CONSTRAINT FK_ID_ENTRADA 
FOREIGN KEY (FK_ENTRADA) 
REFERENCES ENTRADA(CODIGO_ENTRADA);



ALTER TABLE REALIZA_SAIDA
ADD CONSTRAINT FK_USUARIO_SAIDA 
FOREIGN KEY (FK_USUARIO) 
REFERENCES USUARIO(CPF);

ALTER TABLE REALIZA_SAIDA
ADD CONSTRAINT FK_ID_SAIDA 
FOREIGN KEY (FK_SAIDA) 
REFERENCES SAIDA(CODIGO_SAIDA);

ALTER TABLE EXECUTA_ENTRADA
ADD CONSTRAINT FK_PRODUTO_SAIDA 
FOREIGN KEY (FK_PRODUTO) 
REFERENCES PRODUTO(CODIGO_PRODUTO);

ALTER TABLE NOTAFISCAL
ADD CONSTRAINT FK_ID_PRODUTO
FOREIGN KEY (FK_PRODUTO)
REFERENCES PRODUTO (CODIGO_PRODUTO);



ALTER TABLE ENDERECO
ADD CONSTRAINT FK_ID_USUARIO 
FOREIGN KEY (FK_USUARIO) 
REFERENCES USUARIO(CPF);



ALTER TABLE USUARIO
ADD CONSTRAINT FK_CARGO
FOREIGN KEY (FK_NOME_CARGO) 
REFERENCES CARGO(NOME);

--SELECTS

select * from cargo; //para popular lista de cargos da tela de cadastro de usu√°rio
select * from produto; // para popular lista de produtos cadastrados para dar entrada e saida dele

